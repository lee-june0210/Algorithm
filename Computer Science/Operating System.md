# Operating System

* [운영체제](#운영체제)
* [분산 처리 시스템의 분류](#분산-처리-시스템의-분류)
* [프로세스vs스레드](#프로세스vs스레드)
* [병행 프로세스 동기화 유형](#병행-프로세스-동기화-유형)
* 교착상태(=데드락)
* 페이징 세그먼테이션
* 스케줄링
* 페이징기법
* 오버레이
* 스와핑
* 스래싱
* 지역성
* 디스크 스케줄링
* 유닉스
* 리눅스

### 1. 운영체제
 
기능
운영체제는 시스템의 자원과 동작을 관리하는 소프트웨어다. 프로세스 스케줄러, 메모리 관리자, 입출력 관리자, 프로세스 간 통신 관리자, 파일 시스템 관리자

■ 메모리 관리자(Memory Manager)
  프로그램을 실행하기 위해서는 프로그램마다 프로그램 코드와 데이터를 저장하는 메모리가 필요하다. 메모리 관리자는 프로그램이 메모리를 요청하면 적합성 검사를 하고, 적합할 시에 메모리를 할당해주는 역할을 한다. 그리고 할당된 메모리를 다른 프로그램이 사용 또는 접근하지 못하도록 관리하고 보호하는 역할도 한다. 프로그램이 종료될 때에는 할당된 메모리를 회수한다.   
■ 프로세서 관리자(Processor Manager)
  프로그램을 실행하기 위해서는 프로세서가 프로그램 코드를 구성하는 명령어를 하나씩 수행해야 한다. 이때 프로세서 관리자는 명령어들을 효율적으로 실행할 수 있도록 작업 스케줄링(Jop Scheduling)하고 사용자의 작업 요청을 수용하거나 거부하는 역할을 한다.   
 ■ 장치 관리자(Device Manager)
  시스템 안의 모든 장치를 프로그램에 할당하거나 회수하는 역할을 한다.   
■ 파일 관리자(File Manager)
  시스템 안의 데이터, 응용 프로그램 등 모든 파일에 접근 권한을 부여하며, 접근 권한에 따라 파일을 할당(Open)하거나 해체(Close)하는 역할을 한다.   
 ■ 네트워크 관리자(Network Manager)
  네트워크에서 접근 가능한 CPU, 메모리, 프린터, 디스크 드라이버, 모뎀 등의 자원을 관리하는 역할을 한다.   
운영방식
운영체제에는 여러가지 운용기법들이 존재하는데 크게 7가지가 존재합니다. 오늘날 사용하는 OS의 운용기법은 주로 다중 모드 처리 방식과 분산 처리 시스템 방식을 사용합니다.
 
 ■ 일괄처리 시스템 (1950년대)   
일괄 처리 시스템은 초기의 컴퓨터 시스템에서 사용된 형태로, 일정량 또는 일정 기간 동안 데이터를 모아서 한꺼번에 처리하는 방식입니다.   
 
 ■ 시분할 시스템 (1960년대)   
시분할 시스템(Time Sharing System)은 여러 명의 사용자가 사용하는 시스템에서 컴퓨터가 사용자들의 프로그램을 번갈아가며 처리해줌으로써 각 사용자에게 독립된 컴퓨터를 사용하는 느낌을 주는 것으로, 라운드 로빈(Round Robin)방식이라고도 합니다.    
 
■ 다중처리 시스템 
다중 처리 시스템(Multi-Processing System)은 여러개의 CPU와 하나의 주기억장치를 이용하여 여러 개의 프로그램을 동시에 처리하는 방식입니다.
 
  ■  분산 처리 시스템 (1980년대)
분산 처리 시스템(Distributed Processing System)은 여러개의 컴퓨터(프로세서)를 통신 회선으로 연결하여 하나의 작업을 처리하는 방식입니다. 각 단말장치나 컴퓨터 시스템은 고유의 운영체제와 CPU, 메모리를 가지고 있습니다.
 
※ 운영체제의 운용기법의 발달과정
1세대 : 일괄처리 시스템
2세대 : 다중프로그래밍 시스템, 다중 처리 시스템, 시분할 시스템, 실시간 처리 시스템
3세대 : 다중모드
4세대 :  분산 처리 시스템

-------------------------------------

### 2. 분산 처리 시스템의 분류
* 위상에 의한 분류
<br>
Fully Connection(완전 연결) / 망형
  - 노드들이 시스템 내의 모든 노드들과 직접 연결된 구조
  - 기본 비용이 많이 듬
  - 통신 비용은 적게 듬
  - 신뢰성이 높음
  - 메세지 전달이 매우 빠름
  - 사이트 수가 n개이면 링크 연결 수는 n(n-1)/2 이다

Hierarchy(계층) / 트리형
- 분산 처리 시스템의 가장 대표적인 형태
- 부모 노드가 고장나면 자식 노드들은 통신 불가

Star / 성형
- 모든 노드가 하나의 중앙 노드에 직접 연결
- 중앙 노드가 고장나면 모든 통신이 단절

Ring / 환형
- 인접하는 다른 두 노드와만 직접 연결
- 정보는 단방향, 양방향
- 데이터를 전달하기 위해 링을 순환할 경우 통신 비용 증가
- 새로운 노드를 추가할 경우 통신 회선을 절단해야 함

Multi Access Bus Connection(다중 접근 버스 연결)
- 하나의 공유 버스에 연결된 구조(물리적 구조가 간단)
- 노드의 고장은 다른 노드의 통신에 영향을 주지 않음
- 버스의 고장은 통신이 단절
- 노드의 추가, 삭제가 용이

2) 분산 범위에 따른 분류
근거리 통신망(LAN : Local Area Network)
- 회사, 학교, 연구소 등 비교적 가까운 거리에 있는 PC, 프린터, 테이프 등 자원을 연결하여 구성
- 자원 공유가 목적
- site간의 거리가 짧아 데이터 전송 속도가 빠르고 에러 발생률이 낮음
- 주로 버스형, 링형 구조 사용
광대역 통신망(WAN : Wide Area Network)
- 국가와 국가, 대륙과 대륙 등 비교적 먼 거리에 있는 site들을 연결하여 구성
- site간 거리가 멀기 때문에 통신 속도가 느리고, 에러 발생률이 높음
- 일정한 지역에 있는 site들은 LAN으로 연결하고, 각 LAN을 연결하는 방식을 사용


----------------------------------

### 3&4. 프로세스 vs 스레드


프로세스: 운영체제로부터 자원을 할당받은 작업의 단위.
스레드: 프로세스가 할당받은 자원을 이용하는 실행 흐름의 단위.

프로세스(Process) 란
“컴퓨터에서 연속적으로 실행되고 있는 컴퓨터 프로그램”
메모리에 올라와 실행되고 있는 프로그램의 인스턴스(독립적인 개체)
운영체제로부터 시스템 자원을 할당받는 작업의 단위
 
스레드(Thread) 란
“프로세스 내에서 실행되는 여러 흐름의 단위”
프로세스의 특정한 수행 경로
프로세스가 할당받은 자원을 이용하는 실행의 단위
스레드는 프로세스 내에서 각각 Stack만 따로 할당받고 Code, Data, Heap 영역은 공유한다.

- - - - - -

### 5. 병행 프로세스의 동기화 유형

* 임계구역

> 여러 개의 쓰레드로 이루어진 시스템에서 각각의 쓰레드는 코드의 영역을 가지고 있는데 이 부분을 임계구역이라고 한다. 임계구역에서는 공통으로 사용하는 데이터를 바꾸거나 테이블을 업데이트하거나 파일을 쓰거나 하는 일을 할 수 있다.임계구역에서 동기화를 진행하지 못하면 치명적인 문제가 발생한다는 것을 의미한다.


출처: https://copycode.tistory.com/58 [ITstory]

상호 배제(Mutaul Exclusion



 * 상호배제(Mutual Exclusion)   
상호배제는 경쟁 상태의 병행 프로세스간 임계 자원에 속하는 공유 자원에 대한 문제에 있어서 임계 영역(Critical Section)에 한번에 하나의 프로세스만 진입하도록 하는 것이다.
병행 프로세스는 메모리 위에 동시에 존재하는 다수의 프로세스를 의미한다.
임계 영역은 두 개 이상의 프로세스가 한 번에 이용할 수 없는 임계 자원에 대해 접근하고 실행하는 코드 영역이다.
상호배제를 위한 소프트웨어 기법
운영체제의 도움 없이 병행하는 프로세스들이 상호배제를 책임지도록 하는 기법, 임계 영역의 앞뒤로 적절한 처리를 해준다.
하나의 전역 변수를 두어 병행 프로세스간 진출입을 관리하는 경우
임계 영역의 첫 진입이 고정됨
임계 영역의 진입이 타 프로세스에 의해 결정되기 때문에 연속 진입이 불가하고 다른 프로세스가 먼저 종료되는 경우 또 다른 프로세스는 진입이 불가하다.
각 프로세스의 진입을 허용하는 전역 변수를 두어 진출입을 관리하는 경우
두 프로세스의 속도가 교묘히 맞물렸을 때 둘 다 임계영역에 진입하지 못하는 라이브락(Livelock)을 일으킬 수 있다.

시스템의 효율적인 운영을 방해하고 다중 처리 시스템에서 다른 처리기에서 실행되는 프로세스로부터의 접근 가능성은 여전히 존재하기 때문에 사용하기 힘든 방법이다.

임계영역 실행 중 CPU를 선점당할 경우 교착 상태의 가능성   

* 세마포어(Semaphore)   
세 개의 특수한 명령들(초기화, wait, signal)만 접근할 수 있게 허용되는 보호된 변수로 운영체제 수준에서 병행성을 제공하여 상호배제 명령을 구현할 수 있다. 운영체제 수준에서 임계영역 진입을 기다리는 프로세스들을 대기 상태로 전환시킴으로써 바쁜 대기를 할 때의 CPU 낭비를 없앨 수 있다.(block and wakeup) 하지만 바쁜 대기보다 반응이 즉각적이지 못하며 대기 상태로 만드는 비용을 감수해야하며 기아(Starvation)를 일으킬 수 있다.   
세마포어는 상호배제의 구현뿐만 아니라 동기화도 쉽게 구현할 수 있다. 상호 의존 관계의 프로세스 사이에서 두 프로세스의 진행을 조정하여 동기화를 구현한다.
Eventcount와 Sequencer를 사용한 기법
임계영역의 진입을 시도하는 프로세스들에게 순번 표를 부여함으로써 기다린 순서대로 처리되게 하여 기아(Starvation)를 방지할 수 있다.   

* 모니터(Monitor)   
모니터란 공유 데이터들과 이들에 대한 임계영역들을 관리하는 소프트웨어 구성체다. 호출 대기 큐(진입 큐), 조건 큐, 신호자 대기 큐가 필요하다.
wait()을 통해 현재 프로세스를 조건 큐에 넣고 다른 프로세스의 모니터 진입을 허가한다.
signal()을 통해 현재 프로세스를 신호자 대기 큐에 넣고 조건 큐에 대기 중이던 프로세스를 실행한다.
생산자는 데이터를 만들어 버퍼에 저장하고 소비자는 버퍼에 접근하여 데이터를 소비할 때 버퍼는 공유 자원이므로 버퍼에 대한 접근은 상호배제되어야한다. 또한 버퍼가 가득 찼을 때는 생산자가 기다리고, 버퍼가 비었을 때는 소비자가 기다려야하므로 동기화되어야 한다.
식사하는 철학자


- - - - - - - -

### 8. 교착상태(= 데드락)
교착상태 발생의 필요 충분 조건

* 상호배제(Mutual Exclusion)
한번에 한개의 프로세스만이 공유 자원을 사용할 수 있어야 합니다. 
* 점유와 대기(Hold and Wait) 
최소한 하나의 자원을 점유하고 있으면서 다른 프로세스에 할당되어 사용되고 있는 자원을 추가로 점유하기 이해 대기하는 프로세스가 있어야 합니다. 
* 비선점(Non-preemption)
다른 프로세스에 할당된 자원은 사용이 끝날 때까지 강제로 빼앗을 수 없어야합니다. 
* 환형 대기(Circular Wait) 
공유자원과 공유자원을 사용하기 위해 대기하는 프로세스들이 원형으로 구성되어 있어 자신에게 할당된 자원을 점유하면서 앞이나 뒤에 있는 프로세스의 자원을 요구해야 합니다. 
 
 해결방법1_예방기법(Prevention) 
교착상태 예방 기법은 교착상태가 발생하지 않도록 사전에 시스템을 제어하는 방법으로 교착상태 발생의 네가지 조건 중에서 어느 하나를 제거함으로써 수행됩니다. 자원 낭비가 가장 심한 기법입니다.
상호 배제(Mutual Exclusion)부정 : 한번에 여러개의 프로세스가 공유 자원을 사용할 수 있도록 합니다.
점유 및 대기(Hold and Wait) 부정 : 프로세스가 실행되기 전 필요한 모든 자원을 할당하여 프로세스 대기를 없애거나 자원이 점유되지 않은 상태에서만 자원을 요구하도록 합니다.
비선점(Non-preemption)부정 : 자원을 점유하고 있는 프로세스가 다른 자원을 요구할 때 점유하고 있는 자원을 반납하고, 요구한 자원을 사용하기 위해 기다리게 합니다.
환형 대기(Circular Wait)부정 : 자원을 선형 순서로 분류하여 고유 번호를 할당하고, 각 프로세스는 현재 점유한 자원의 고유 번호보다 앞이나 뒤 어느 한쪽 방향으로만 자원을 요구하도록 하는것입니다.
해결방법2_ 회피 기법(Avoidance) 
교착상태 회피 기법은 교착상태가 발생할 가능성을 배제하지 않고 교착상태가 발생하면 적절히 피해나가는 방법으로, 주로 은행원 알고리즘(Banker's Algorithm)이 사용됩니다.
 
은행원 알고리즘
1. 은행원 알고리즘은 다익스트라가 제안한 기법으로, 은행에서 모든 고객의 요구가 충족되도록 현금을 할당하는데서 유래한 기법입니다.
2. 각 프로세스에게 자원을 할당하여 교착상태가 발생하지 않으며 모든 프로세스가 완료될 수 있는 상태를 안전상태, 교착상태가 발생할 수 있는 상태를 불안전 상태라고 합니다.
3. 은행원 알고리즘을 적용하기 위해서는 자원의 양과 사용자(프로세스) 수가 일정해야 합니다.
4. 은행원 알고리즘은 프로세스의 모든 요구를 유한한 시간안에 할당하는 것을 보장합니다.
해결방법3_발견 기법
해결방법4_회복 기법

### 페이징과 세그먼테이션

----------

##### 기법을 쓰는 이유

> 다중 프로그래밍 시스템에 여러 프로세스를 수용하기 위해 주기억장치를 동적 분할하는 메모리 관리 작업이 필요해서

<br>

> 페이징 
* 고정 분할
* 내부 단편화 발생
  > 동작 방식
  논리(가상) 메모리는 페이지(Page)이라 불리는 고정 크기의 블록으로 나누어지고, 물리 메모리는 프레임(Frame)라 불리는 페이지과 같은 크기의 블록들로 나누어짐. 보조 메모리 역시 프레임과 같은 크기의 블록들로 나누어짐.

세그먼테이션
* 동적 분할
* 외부 단편화 발생 

##### 주기억 장치(메인메모리,RAM,물리메모리) 할당 기법
- 고정분할(정적 분할) 단순 페이징
- 가변분할(동적 분할) 단순 세그먼테이션

##### 보조 기억 장치(논리 메모리, 가상메모리) 할당 기법
- 고정분할(정적 분할) 페이징
- 가변분할(동적 분할) 세그멘테이션
